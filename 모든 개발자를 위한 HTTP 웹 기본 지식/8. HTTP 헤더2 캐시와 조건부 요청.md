## 8. HTTP 헤더2 - 캐시와 조건부 요청

#### 캐시 기본 동작

캐시가 없다면, 데이터가 변경되지 않아도 계속 네트워크를 통해 데이터를 다운 받아야 한다.

-> 브라우저 속도가 느림!

**✅ 캐시를 적용하면?**

cache-control: max-age=60 을 사용하면 캐시가 유효한 시간을 지정해줄 수 있다.

웹 브라우저에는 캐시 저장소가 존재한다. cache-control에 적힌 시간동안 응답 결과를 캐시에 저장한다.

두 번째 요청할 때는 찾으려는 항목이 캐시에 있는지 확인한 후 캐시 저장소에서 가져온다.

이 때, 이 요청 시간이 초과되면 서버에서 다시 응답을 받아야 한다.

<br/>

#### 검증 헤더와 조건부 요청

캐시 시간이 초과된 후에도 서버에서 해당 데이터가 변경되지 않았다면 저장해 두었던 캐시를 그대로 쓸 수 있다.

변경되지 않았다는 것이 확인만 된다면!

**🍒 검증 헤더 추가** 

```
cache-control: max-age=60
Last-Modified: 2020년 11월 10일 10:00:00
```

헤더의 Last-Modified를 통해 마지막 최종수정일을 알 수 있다.

캐시 저장소에서는 이 응답 결과를 받아 Last-Modified도 함께 저장한다.

이 60초가 초과된다면 클라이언트는 서버에 if-modified-since를 포함해 요청을 보낸다.

```
GET /star.jpg
if-modified-since: 2020년 11월 10일 10:00:00
```

<br/>

✅ 만약에 최종 수정일에 변동이 없다면

```
HTTP/1.1 304 Not Modified
Content-Type: image/jpeg
cache-control: max-age=60
Last-Modified: 2020년 11월 10일 10:00:00
Content-Length: 34012
```

<u>❗ 여기서는 HTTP Body가 없음</u>

Body없이 헤더 메타 정보만 오기 때문에 전송할 수 있는 용량을 훨씬 줄일 수 있다.

