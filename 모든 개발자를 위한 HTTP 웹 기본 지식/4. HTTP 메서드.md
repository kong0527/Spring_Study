## 4. HTTP 메서드

#### API URI 설계

URI 설계시 가장 중요한 것은 **<u>★리소스 식별★</u>**

'회원관리'가 있을 때, 리소스는 바로 <u>회원</u>이다. 따라서, 회원을 등록, 수정, 조회 하는 것은 배제하고 회원 리소스만 URI에 매핑해주면 된다.

즉! 회원관리와 관련된 URI를 설계하려면 /members/{id} 의 형식이 되어야 한다.

그런데, 조회, 등록, 수정이 모두 /members/{id} 형식이라면 행위를 어떻게 구분해야 할까?

-> HTTP 메서드로 구분한다!

<br/>

#### HTTP 메서드

-> 클라이언트가 서버에 요청을 할 때, 기대하는 행동

**🍒 GET** - 리소스 조회

서버에 전달하고 싶은 데이터를 query를 통해 전달

메시지 바디를 사용해 전달할 수 있지만, 권장 X

클라이언트에서 요청을 보내고 서버에서 /members/100 이라는 요청을 받으면 DB에서 해당 정보를 조회해 아래와 같이 응답 데이터를 반환한다.

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 34
{
 "username": "young",
 "age": 20
}
```

<br/>

**🍒 POST** - 요청 데이터 처리 (주로 등록)

메시지 바디를 통해 서버로 요청 데이터를 전달한다. 

서버는 요청을 처리하고 아래와 같이 응답 데이터를 보낸다.

```
HTTP/1.1 201 Created
Content-Type: application/json
Content-Length: 34
Location: /members/100 -> 자원이 신규 생성된 path
{
 "username": "young",
 "age": 20
}
```

사실 POST는 데이터 등록 뿐 아니라, 아래와 같은 기능에 사용되기도 한다.

* HTML 양식에 입력된 데이터 블록을 처리 프로세스에 제공

* 게시판 글쓰기, 댓글 달기

* 기존 자원에 데이터 추가 (한 문서 끝에 내용 추가)

* 단순히 데이터를 생성, 변경하는 것을 넘어 프로세스를 처리해야 하는 경우

  예) 주문세어 결제 완료 -> 배달 시작 과 같이 프로세스의 상태가 변경되는 경우

* 다른 메서드로 처리하기 애매한 경우

  예) JSON으로 조회 데이터를 넘겨야 하는데, GET 메서드를 사용하기 어려운 경우

<br/>

**🍒 PUT** - 리소스 대체 (없으면 생성)

없으면 생성, 있으면 완전히 대체

★중요! 클라이언트가 리소스를 식별한다. 

클라이언트가 리소스 위치를 알고 URI를 지정한다 - POST와의 큰 차이점

(POST는 /members를 호출하고 서버가 /members/100을 돌려준다면, PUT은 /members/100으로 호출하는 것)

⚠ 주의할 점

기존에 { "username": "old", "age": 50 } 데이터가 있는 경우, { "age": 20 } 만 새로 보내면 username 관련 정보는 사라진다. 아예 대체해버리기 때문. 따라서 데이터를 수정하기 어렵다. -> PATCH를 사용해 수정

<br/>**🍒 PATCH** - 리소스 부분 변경

위와 같은 경우에서, { "age": 20 } 만 보내면 { "username": "old", "age": 20 } 과 같이 수정이 된다.

<br/>**🍒 DELETE** - 리소스 삭제

```
DELETE /members/100 HTTP/1.1
Host: localhost:8080
```

위와 같이 요청하면 서버에서 리소스를 삭제한다.

<br/>

[기타]

HEAD - GET과 동일하지만, 상태 줄과 헤더만 반환 (메시지 X)

OPTIONS - 대상 리소스에 대한 통신 가능 옵션을 설명 (주로 CORS에서 사용)

CONNECT - 대상 자원으로 식별되는 서버에 대한 터널 설정

TRACE - 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트 수행

#### HTTP 메서드 속성

![image](https://user-images.githubusercontent.com/64277114/172520474-c48c68cd-8751-4f64-9981-76de75c6cc8d.png)

안전 : 여러번 호출해도 리소스가 변경되지 않는다.

멱등 : 한 번 호출하든 두 번 호출하든 결과가 똑같다.

(멱등은 자동 복구 메커니즘에 사용될 수 있다.)

캐시가능 : 응답 결과 리소스를 캐싱해서 사용해도 되는가 -> 실제로는 GET, HEAD정도만 사용