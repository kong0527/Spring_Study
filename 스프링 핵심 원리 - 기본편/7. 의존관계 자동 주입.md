## 7. ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…

#### ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•

**ğŸ€ ìƒì„±ì ì£¼ì…**

ì´ë¦„ ê·¸ëŒ€ë¡œ ìƒì„±ìë¥¼ í†µí•´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²• (ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ì§„í–‰í–ˆë˜ ë°©ë²•)

íŠ¹ì§•

* ìƒì„±ì í˜¸ì¶œì‹œì ì— ë”± í•œ ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.
* ë¶ˆë³€, í•„ìˆ˜ ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
* â˜… ì¤‘ìš”! ìƒì„±ìê°€ ë”± í•œ ê°œë§Œ ìˆìœ¼ë©´ @Autowiredë¥¼ ìƒëµí•´ë„ ìë™ìœ¼ë¡œ ì£¼ì…ëœë‹¤.

<br/>

**ğŸ€ ìˆ˜ì •ì ì£¼ì…**

setterë¼ ë¶ˆë¦¬ëŠ” í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•

íŠ¹ì§•

* ì„ íƒ, ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
* ìë°”ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

```java
@Autowired
public void setMemberRepository(MemberRepository memberRepository) {
    this.memberRepository = memberRepository;
}
```

! ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´ @Autowired(required = false) ì‚¬ìš©í•  ê²ƒ

<br/>

**ğŸ€ í•„ë“œ ì£¼ì…**

ì´ë¦„ ê·¸ëŒ€ë¡œ í•„ë“œì— ì£¼ì…í•˜ëŠ” ë°©ë²•

íŠ¹ì§•

* ì½”ë“œê°€ ê°„ê²°í•˜ì§€ë§Œ ì™¸ë¶€ì—ì„œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•´ í…ŒìŠ¤íŠ¸ í•˜ê¸° í˜ë“¤ë‹¤ëŠ” ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ìˆë‹¤.
* DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤.
* ìŠ¤í”„ë§ ì„¤ì •ì„ ëª©ì ìœ¼ë¡œ í•˜ëŠ” @Configuration ê°™ì€ ê³³ì—ì„œë§Œ íŠ¹ë³„í•œ ìš©ë„ë¡œ ì‚¬ìš©

```java
@Autowired
private MemberRepository memberRepository;
```

<br/>

**ğŸ€ ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…**

ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.

íŠ¹ì§•

* í•œ ë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.
* ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
@Autowired
public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
```

<br/>

#### ì˜µì…˜ ì²˜ë¦¬

ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë–„ê°€ ìˆë‹¤.

@AutowiredëŠ” requiredì˜ ê¸°ë³¸ê°’ì´ trueë¼ì„œ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

* @Autowired(required = false) : ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œ X
* org.springframework.lang.@Nullable : ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥
* Optional<> : ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ Optional.empty ì…ë ¥

<br/>

#### ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ

@AutowiredëŠ” Typeìœ¼ë¡œ ì¡°íšŒë¥¼ í•œë‹¤. ë”°ë¼ì„œ, ac.getBeanê³¼ ìœ ì‚¬í•˜ê²Œ ë™ì‘í•œë‹¤.

í•˜ì§€ë§Œ, íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•  ë•Œ ì„ íƒëœ ë¹ˆì´ 2ê°œ ì´ìƒì´ë©´ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, DiscountPolicyì˜ í•˜ìœ„ íƒ€ì…ì¸ FixDiscountPolicy, RateDiscountPolicyë¥¼ ë‘˜ ë‹¤ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì„ ì–¸í•˜ê²Œ ë˜ë©´ NoUniqueBeanDefinitionException ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì´ ë•Œ ì–´ë–»ê²Œ í•´ê²°ì„ í•´ì•¼ í• ê¹Œ?

<br/>

**ğŸ€ @Autowiredì— í•„ë“œëª… ë§¤ì¹­**

@AutowiredëŠ” ì²˜ìŒì— íƒ€ì… ë§¤ì¹­ì„ ì‹œë„í•˜ê³ , ì—¬ëŸ¬ ë¹ˆì´ ìˆìœ¼ë©´ í•„ë“œ ì´ë¦„, íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë¹ˆ ì´ë¦„ì„ ì¶”ê°€ ë§¤ì¹­í•œë‹¤.

```java
@Autowired
    public OrderServiceImpl(MemberRepository memberRepository, 
                            DiscountPolicy rateDiscountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = rateDiscountPolicy;
    }
```

rateDiscountPolicyë¡œ ë³€ê²½í•´ì£¼ë©´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•œë‹¤.

<br/>

**ğŸ€ @Qualifierë¼ë¦¬ ë§¤ì¹­**

@QualifierëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•ì´ë‹¤. 

ì£¼ì…ì‹œ ì¶”ê°€ì ì¸ ë°©ë²•ì„ ì œê³µí•˜ëŠ” ê²ƒì´ê³  ë¹ˆ ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

```java
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy {}
```

```java
@Component
@Qualifier("fixDiscountPolicy")
public class FixDiscountPolicy implements DiscountPolicy {}
```

ë¹ˆ ë“±ë¡ì‹œ ìœ„ì™€ ê°™ì´ @Qualifierë¥¼ ë¶™ì—¬ ì¤€ë‹¤.

(ì§ì ‘ ë¹ˆ ë“±ë¡ì‹œì—ë„ @Beanê³¼ í•¨ê»˜ @Qualifierë¥¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.)

```java
@Autowired
public OrderServiceImpl(MemberRepository memberRepository,
                        @Qualifier("mainDiscountPolicy") DiscountPolicy
                        discountPolicy) {
     this.memberRepository = memberRepository;
     this.discountPolicy = discountPolicy;
}
```

ì£¼ì… ì‹œì—ëŠ” @Qualifierë¥¼ ë¶™ì—¬ì£¼ê³  ë“±ë¡í•œ ì´ë¦„ì„ ì ì–´ì¤€ë‹¤.

ë§Œì•½ mainDiscountPolicyë¥¼ ëª»ì°¾ìœ¼ë©´ mainDiscountPolicyë¼ëŠ” ì´ë¦„ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ì¶”ê°€ë¡œ ì°¾ëŠ”ë‹¤.

<br/>

**ğŸ€ @Primary ì‚¬ìš©**

@PrimaryëŠ” ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤. @Autowired ì‹œì— ì—¬ëŸ¬ ë¹ˆì´ ë§¤ì¹­ë˜ë©´ @Primaryê°€ ìš°ì„ ê¶Œì„ ê°€ì§„ë‹¤.

```java
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy {}
@Component
public class FixDiscountPolicy implements DiscountPolicy
```

<br/>

**âš  @Primary, @Qualifier í™œìš©**

ì½”ë“œì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìˆê³ , íŠ¹ë³„í•œ ê¸°ëŠ¥ìœ¼ë¡œ ê°€ë” ì‚¬ìš©í•˜ëŠ” ì„œë¸Œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ë©”ì¸ì€ @Primaryë¥¼ ì ìš©í•´ì„œ ì¡°íšŒí•˜ê³ , ì„œë¸ŒëŠ” @Qualifierë¥¼ ì§€ì •í•´ì„œ ëª…ì‹œì ìœ¼ë¡œ íšë“í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ì½”ë“œë¥¼ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.

@Qualifierê°€ @Primaryë³´ë‹¤ ìš°ì„ ê¶Œì´ ë†’ë‹¤.

<br/>

#### ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°

@Qualifierë¡œ ì§€ì •ì„ í•  ë•Œ, ì˜¤íƒ€ë¥¼ ë°œê²¬í•  ìˆ˜ ì—†ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.

```java
import org.springframework.beans.factory.annotation.Qualifier;
import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER,
        ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {

}
```

ìœ„ì™€ ê°™ì´ ì„ ì–¸í•œ í›„, ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.

```java
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, 
                            @MainDiscountPolicy DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
```